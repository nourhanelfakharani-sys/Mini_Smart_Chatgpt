<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Mini GPT</title>
<style>
body {margin:0; background: linear-gradient(to right,#667eea,#764ba2); font-family: 'Segoe UI', sans-serif; display:flex; justify-content:center; align-items:center; height:100vh;}
.chat-container {width:400px; height:600px; background:#fff; border-radius:15px; box-shadow:0 0 20px rgba(0,0,0,0.3); display:flex; flex-direction:column;}
.chat-header {background:#4A90E2; color:white; padding:15px; text-align:center; font-weight:bold;}
.chat-box {flex:1; padding:15px; overflow-y:auto; background:#f5f5f5; display:flex; flex-direction:column;}
.message {margin:10px 0; padding:10px; border-radius:10px; max-width:80%; animation:fadeIn 0.4s ease-in-out;}
.user {background:#d1e7dd; align-self:flex-end; text-align:right;}
.bot {background:#e2e3e5; align-self:flex-start; text-align:left;}
.timestamp {font-size:10px; color:#777; margin-top:5px;}
.input-area {display:flex; border-top:1px solid #ccc;}
input {flex:1; padding:10px; border:none; font-size:16px;}
button {padding:10px 15px; background:#4A90E2; color:white; border:none; cursor:pointer; font-size:18px;}
@keyframes fadeIn {from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);}}
@media (max-width:500px) {.chat-container {width:90%; height:90vh;}}
</style>
</head>
<body>
<div class="chat-container">
<div class="chat-header">Smart Mini GPT ü§ñ</div>
<div class="chat-box" id="chatBox"></div>
<div class="input-area">
<input type="text" id="userInput" placeholder="Type your message..." onkeypress="if(event.key==='Enter')sendMessage()" />
<button onclick="sendMessage()">Send</button>
</div>
</div>

<script>
async function sendMessage() {
    const input = document.getElementById("userInput");
    const chatBox = document.getElementById("chatBox");
    const msg = input.value.trim();
    if (!msg) return;

    chatBox.innerHTML += `<div class="message user"><strong>You:</strong> ${msg}<div class="timestamp">${new Date().toLocaleTimeString()}</div></div>`;
    chatBox.innerHTML += `<div id="typing" class="message bot"><strong>Bot:</strong> Bot is typing...<div class="timestamp">${new Date().toLocaleTimeString()}</div></div>`;
    chatBox.scrollTop = chatBox.scrollHeight;
    input.value = "";

    try {
        const res = await fetch("/chat", {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message:msg})
        });
        const data = await res.json();
        document.getElementById("typing")?.remove();
        chatBox.innerHTML += `<div class="message bot"><strong>Bot:</strong> ${data.reply}<div class="timestamp">${new Date().toLocaleTimeString()}</div></div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    } catch(err) {
        document.getElementById("typing")?.remove();
        chatBox.innerHTML += `<div class="message bot"><strong>Bot:</strong> ‚ùå Error connecting to server<div class="timestamp">${new Date().toLocaleTimeString()}</div></div>`;
    }
}
</script>
</body>
</html>
